<app-component-dynamic-heading [heading]="'MANAGE RECIPIENT'"></app-component-dynamic-heading>

<div class="container py-5">
     <mat-form-field appearance="fill">
            <mat-label>Seat number</mat-label>
            <select matNativeControl required (change)="filterChange(seatSelected,vaccinatorSelected)" value="select"  #seatSelected>
                <option value="select" selected>Select</option>
                <option *ngFor="let checkedInItem of seatsList;" value="{{checkedInItem}}">{{checkedInItem}}</option>
            </select>
    </mat-form-field>

    <mat-form-field appearance="fill">
        <mat-label>Vaccinator</mat-label>        
        <select matNativeControl required (change)="filterChange(seatSelected,vaccinatorSelected)" value="select" #vaccinatorSelected>
            <option value="select" selected>Select</option>          
        </select>
    </mat-form-field>

    <div class="d-flex align-items-center pt-5 pb-4">
        <h5 class="appointment-hed-text roboto-medium-20">Appointments</h5>
        <h5 class="appointment-hed-text roboto-medium-20 px-3">|</h5>
        <h5 class="appointment-hed-text roboto-regular-20">{{todayDate |date:'EEEE, dd-MMMM-yyyy'}}</h5>
       
    </div>

    <div class="d-flex align-items-center pt-5 pb-4">
        <mat-form-field>
            <input matInput type="text" placeholder="Search" (keyup)="filterList(ele,true)" #ele>
            <button mat-button matSuffix mat-icon-button (click)="filterList(ele,false)">
              <mat-icon>search</mat-icon>
            </button>
          </mat-form-field>   
    </div>   

    <div class="d-flex my-0 py-0 justify-content-center">
        <ul class="nav my-0 nav-pills d-flex w-100" id="myTab" role="tablist">
            <li class="nav-item m-0 h-100 w-25">
                <a class="nav-link active roboto-medium-18" data-toggle="tab" href="#upcoming" role="tab"
                    aria-controls="upcoming" aria-selected="true">
                    Upcoming({{ upcomingList.length }})
                </a>
            </li>
            <li class="nav-item m-0 h-100 w-25">
                <a class="nav-link roboto-medium-18" data-toggle="tab" href="#checkedin" role="tab"
                    aria-controls="checkedin" aria-selected="false">
                    Checked-in({{ checkedInList.length }})
                </a>
            </li>
            <li class="nav-item m-0 h-100 w-25">
                <a class="nav-link roboto-medium-18" data-toggle="tab" href="#observation" role="tab"
                    aria-controls="observation" aria-selected="false">
                    Observation({{ observationList.length }})
                </a>
            </li>
            <li class="nav-item m-0 h-100 w-25">
                <a class="nav-link roboto-medium-18" data-toggle="tab" href="#completed" role="tab"
                    aria-controls="completed" aria-selected="false">
                    Completed({{ completedList.length }})
                </a>
            </li>
        </ul>
    </div>

    <div class="tab-content my-0" id="myTabContent">
        <div class="tab-pane active" id="upcoming" role="tabpane2" aria-labelledby="upcoming">
            <table class="table  text-center">
                <thead>
                    <tr>
                        <th class="roboto-regular-18 blue-bg white-text">Time</th>
                        <th class="roboto-regular-18 blue-bg white-text text-left">Recipient</th>
                        <!-- <th class="roboto-regular-18 blue-bg white-text">Dose</th> -->
                        <th class="roboto-regular-18 blue-bg white-text">Dose</th>
                        <th class="roboto-regular-18 blue-bg white-text">Vaccinator</th>
                        <th class="roboto-regular-18 blue-bg white-text">Seat</th>
                        <th class="roboto-regular-18 blue-bg white-text">Vaccine</th>
                        <th class="roboto-regular-18 blue-bg white-text">&nbsp;</th>
                    </tr>
                </thead>
                <tbody>
                    <tr     *ngFor="let upcomingListItem of upcomingList;"
                            (click)="setVisitRowToLocalStorage(upcomingListItem)"
                            data-toggle="modal"
                            data-target="#exampleModal1">
                        <td class="txt" style="width: 20%;">
                            <span class="roboto-medium-16">{{ upcomingListItem.start_time |
                                date:'hh:mm'}}</span>&nbsp;<span>pm</span>
                        </td>
                        <td class="text-left" style="width: 20%;">
                            <div class="d-flex align-items-center">
                                <img src="../../../../assets/images/vaccinator/Image 5.png">
                                <p class="txt roboto-medium-16 m-0 ml-1" style="width: 20%;"> {{
                                    upcomingListItem.$expanded.recipient_fname+"&nbsp;"+upcomingListItem.$expanded.recipient_lname
                                    }} </p>
                            </div>
                        </td>
                        
                        <td class="roboto-regular-16 txt">
                            
                            <ng-template *ngIf="upcomingListItem.dose_in_series=='1';else nd">
                                {{upcomingListItem.dose_in_series}}<sup>st</sup> dose
                            </ng-template>
                            <ng-template #nd>
                                {{upcomingListItem.dose_in_series}}<sup>nd</sup> dose
                            </ng-template>
                           
                        </td>
                        <td class="roboto-regular-16 txt">{{upcomingListItem.$expanded.vaccinator_name}}</td>
                        <td class="roboto-regular-16 txt">{{upcomingListItem.$expanded.seat_name}} </td>
                        <td class="roboto-regular-16 txt">{{upcomingListItem.$expanded.vaccine}}</td>
                       
                        <td class="txt d-flex justify-content-end">
                            <span class="badge badge-blue mx-2" style="cursor: pointer">Walk-in</span>
                            <div class="mx-1"  style="cursor: pointer" [routerLink]="['/vaccinator/checklist', upcomingListItem.id, 'upcoming']">
                                <i class="fa fa-pencil-square-o" style="cursor: pointer">checklist</i> 
                            </div>
                        </td>

                    </tr>
                </tbody>
            </table>
        </div>

        <div class="tab-pane" id="checkedin" role="tabpane2" aria-labelledby="checkedin">
            <table class="table  text-center" *ngIf="checkedInList.length>=0">
                <thead>
                    <tr>
                        <th class="roboto-regular-18 blue-bg white-text">Time</th>
                        <th class="roboto-regular-18 blue-bg white-text text-left">Recipient</th>
                        <!-- <th class="roboto-regular-18 blue-bg white-text">Dose</th> -->
                        <th class="roboto-regular-18 blue-bg white-text">Dose</th>
                        <th class="roboto-regular-18 blue-bg white-text">Vaccinator</th>
                        <th class="roboto-regular-18 blue-bg white-text">Seat</th>
                        <th class="roboto-regular-18 blue-bg white-text">Vaccine</th>
                        <th class="roboto-regular-18 blue-bg white-text">&nbsp;</th>
                        <th class="roboto-regular-18 blue-bg white-text">&nbsp;</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let checkedInItem of checkedInList;"
                    (click)="setVisitRowToLocalStorage(checkedInItem)" data-toggle="modal"
                    data-target="#exampleModal1">
                        <td class="txt" style="width: 20%;">
                            <span class="roboto-medium-16">{{ checkedInItem.start_time |
                                date:'hh:mm'}}</span>&nbsp;<span>pm</span>
                        </td>
                        <td class="text-left" style="width: 20%;">
                            <div class="d-flex align-items-center">
                                <img src="../../../../assets/images/vaccinator/Image 5.png">
                                <p class="txt roboto-medium-16 m-0 ml-1" style="width: 20%;"> {{
                                    checkedInItem.$expanded.recipient_fname+"&nbsp;"+checkedInItem.$expanded.recipient_lname
                                    }} </p>
                            </div>
                        </td>                     
                        <td class="roboto-regular-16 txt">                         
                            <ng-template *ngIf="checkedInItem.dose_in_series=='1';else nd">
                                {{checkedInItem.dose_in_series}}<sup>st</sup> dose
                            </ng-template>
                            <ng-template #nd>
                                {{checkedInItem.dose_in_series}}<sup>nd</sup> dose
                            </ng-template>
                        </td>
                        <td class="roboto-regular-16 txt">{{checkedInItem.$expanded.vaccinator_name}}</td>
                        <td class="roboto-regular-16 txt">{{checkedInItem.$expanded.seat_name}}</td>
                        <td class="roboto-regular-16 txt">{{checkedInItem.$expanded.vaccine}}</td>
                        <td class="txt d-flex justify-content-end">
                           <!-- <span class="badge badge-blue mx-2">Queue no-02</span> -->
                            <div class="mx-1"  style="cursor: pointer" [routerLink]="['/vaccinator/checklist', checkedInItem.id, 'upcoming']">
                                <i class="fa fa-pencil-square-o"></i> checklist
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="tab-pane" id="observation" role="tabpane3" aria-labelledby="observation">
            <table class="table text-center" *ngIf="observationList.length>=0">
                <thead>
                    <tr>
                        <th class="roboto-regular-18 blue-bg white-text">Time</th>
                        <th class="roboto-regular-18 blue-bg white-text text-left">Recipient</th>
                        <!-- <th class="roboto-regular-18 blue-bg white-text">Dose</th> -->
                        <th class="roboto-regular-18 blue-bg white-text">Dose</th>
                        <th class="roboto-regular-18 blue-bg white-text">Vaccinator</th>
                        <th class="roboto-regular-18 blue-bg white-text">Seat</th>
                        <th class="roboto-regular-18 blue-bg white-text">Vaccine</th>
                        <th class="roboto-regular-18 blue-bg white-text">&nbsp;</th>
                        <th class="roboto-regular-18 blue-bg white-text">&nbsp;</th>
                    </tr>
                </thead>
                <tbody>
                    <tr  style="cursor: pointer"
                    *ngFor="let observationItem of observationList;"
                    (click)="setVisitRowToLocalStorage(observationItem)" 
                    data-toggle="modal"
                    [routerLink]="['/vaccinator/recepient', observationItem.id, 'observation']"
                        >
                        <td class="txt" style="width: 20%;">
                            <span class="roboto-medium-16">{{ observationItem.start_time |
                                date:'hh:mm'}}</span>&nbsp;<span>pm</span>
                        </td>
                        <td class="text-left" style="width: 20%;">
                            <div class="d-flex align-items-center">
                                <img src="../../../../assets/images/vaccinator/Image 5.png">
                                <p class="txt roboto-medium-16 m-0 ml-1" style="width: 20%;"> {{
                                    observationItem.$expanded.recipient_fname+"&nbsp;"+observationItem.$expanded.recipient_lname
                                    }} </p>
                            </div>
                        </td>
                       
                        <td class="roboto-regular-16 txt">                            
                            <ng-template *ngIf="observationItem.dose_in_series=='1';else nd">
                                {{observationItem.dose_in_series}}<sup>st</sup> dose
                            </ng-template>
                            <ng-template #nd>
                                {{observationItem.dose_in_series}}<sup>nd</sup> dose
                            </ng-template>
                        </td>
                        <td class="roboto-regular-16 txt">{{observationItem.$expanded.vaccinator_name}}</td>
                        <td class="roboto-regular-16 txt">{{observationItem.$expanded.seat_name}}</td>
                        <td class="roboto-regular-16 txt">{{observationItem.$expanded.vaccine}}</td>
                        
                        <td class="txt d-flex justify-content-end">
                            <span class="badge badge-danger mx-3">Report an adverse reaction</span>
                            <div class="mx-1"  style="cursor: pointer" [routerLink]="['/vaccinator/checklist', observationItem.id, 'upcoming']">
                                <i class="fa fa-pencil-square-o"></i> checklist
                            </div>
                        </td>
<!--
                        <td class="txt d-flex justify-content-end">
                            <div class="mx-3 text-left" style="width: 360px;">
                               <span class="badge badge-danger mx-3">Report an adverse reaction</span>
                            </div>
                            <div class="mx-3" [routerLink]="'/vaccinator/checklist'">
                                checklist
                            </div>
                        </td> -->

                    </tr>
                </tbody>
            </table>
        </div>

        <div class="tab-pane" id="completed" role="tabpanel" aria-labelledby="completed">
            <table class="table text-center" *ngIf="completedList.length>=0">
                <thead>
                    <tr>
                        <th class="roboto-regular-18 blue-bg white-text">Time</th>
                        <th class="roboto-regular-18 blue-bg white-text text-left">Recipient</th>
                        <!-- <th class="roboto-regular-18 blue-bg white-text">Dose</th> -->
                        <th class="roboto-regular-18 blue-bg white-text">Dose</th>
                        <th class="roboto-regular-18 blue-bg white-text">Vaccinator</th>
                        <th class="roboto-regular-18 blue-bg white-text">Seat</th>
                        <th class="roboto-regular-18 blue-bg white-text">Vaccine</th>
                        <th class="roboto-regular-18 blue-bg white-text">&nbsp;</th>
                        <th class="roboto-regular-18 blue-bg white-text">&nbsp;</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let completedItem of completedList;" data-toggle="modal">
                      <td class="txt" style="width: 20%;">
                            <span class="roboto-medium-16">{{ completedItem.start_time |
                                date:'hh:mm'}}</span>&nbsp;<span>pm</span>
                        </td>
                        <td class="text-left" style="width: 20%;">
                            <div class="d-flex align-items-center">
                                <img src="../../../../assets/images/vaccinator/Image 5.png">
                                <p class="txt roboto-medium-16 m-0 ml-1" style="width: 20%;"> {{
                                    completedItem.$expanded.recipient_fname+"&nbsp;"+completedItem.$expanded.recipient_lname
                                    }} </p>
                            </div>
                        </td>
                        <!-- <td class="roboto-regular-16 txt">
                            1st&nbsp;dose
                        </td> -->
                        <td class="roboto-regular-16 txt">
                            <ng-template *ngIf="completedItem.dose_in_series=='1';else nd">
                                {{completedItem.dose_in_series}}<sup>st</sup> dose
                            </ng-template>
                            <ng-template #nd>
                                {{completedItem.dose_in_series}}<sup>nd</sup> dose
                            </ng-template>
                        </td>
                        <td class="roboto-regular-16 txt">{{completedItem.$expanded.vaccinator_name}}</td>
                        <td class="roboto-regular-16 txt">{{completedItem.$expanded.seat_name}}</td>
                        <td class="roboto-regular-16 txt">{{completedItem.$expanded.vaccine}}</td>
                        <td class="txt d-flex justify-content-end">
                            
                            <div class="mx-1" style="cursor: pointer" [routerLink]="['/vaccinator/checklist', completedItem.id, 'upcoming']">
                                <i class="fa fa-pencil-square-o"></i> checklist
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

    </div>
</div>
<!-- Modal 1 -->
<div class="modal fade" id="exampleModal1" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
    aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-body text-center">
                <h3 class="text-dark" id="exampleModalLabel">Start Appointment</h3>
                <p class="text-muted">Are you sure want to start the {{currentVisitRow.start_time|date:'hh:mm a'}}
                    appointment, If yes please
                    Validate ID and Start Appointment</p>
                <div class="form-group mr-2">
                    <select class="form-control" [(ngModel)]="selectedOption">
                        <option value="" selected>Recipient Identification Type</option>
                        <option value="Passport">Passport</option>
                        <option value="Driving Lisence">Drivers License</option>
                        
                    </select>
                </div>
            </div>
            <div class="modal-footer p-0 m-0 d-flex justify-content-between">
                <button data-dismiss="modal" aria-label="Close" type="button"
                    class="btn blue-text px-5 shadow-none">Cancel</button>
                <button data-dismiss="modal" aria-label="Close" type="button" class="btn blue-text px-5 shadow-none"
                    [routerLink]="['/vaccinator/checklist', currentVisitRow.id, 'start']"
                    [disabled]="selectedOption.trim()==''">Start</button>
            </div>
        </div>
    </div>
</div>

